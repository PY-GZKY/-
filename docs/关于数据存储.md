在选择数据库系统存储爬虫数据时，它们各有其特点和最适用的场景。

### 1. MySQL

- **关系型数据库**：遵循SQL标准，适合需要事务支持和复杂查询的应用。
- **成熟稳定**：广泛应用于各种网站和应用程序，社区支持强大。
- **数据一致性和完整性**：提供强大的数据一致性保证和完整性约束。

应用场景：

- 需要结构化查询语言（SQL）和复杂联结的场合。
- 数据结构相对固定，不频繁改变的应用。
- 需要高度事务性的应用，如电子商务网站。

### 2. SQL Server

- **关系型数据库**：提供高级的事务处理和数据分析功能。
- **紧密集成于Microsoft技术栈**：在Windows平台上性能优化良好。
- **安全性和可靠性**：提供多层次的安全特性，适合企业级应用。

应用场景：

- 企业环境中，尤其是依赖Microsoft技术栈的场合。
- 需要复杂报表和数据分析的应用。
- 高并发、高可用性和数据安全性要求较高的应用。

### 3. MongoDB

- **非关系型数据库**（NoSQL）：文档存储，数据结构灵活。
- **高性能**：优化读写性能，尤其是在处理大量小文档时表现良好。
- **水平扩展**：通过分片实现水平扩展，适合大数据量存储。

应用场景：

- 数据结构变化频繁或未定义明确的应用。
- 需要存储大量不需要复杂查询的半结构化数据。
- 实时大数据应用，如日志数据分析、内容管理系统等。

### 如何选择数据库？

首先，如果爬取的数据结构规范且需要频繁执行联结操作，MySQL是一个好选择。
如果爬虫系统是在主要使用 Microsoft 技术的企业环境中，或者需要严格的数据一致性和安全性，可以选择 SQL Server。

MongoDB用于爬取的数据量巨大且结构多变，MongoDB的灵活性和扩展性可能更适合。

总的来说，选择哪种数据库取决于你的具体需求、数据类型、预期的查询负载以及现有的技术栈。

在实际应用中，也可以考虑结合使用这些数据库，以发挥各自的优势。
例如，使用MongoDB处理和存储大量的原始爬虫数据，而将处理后的数据迁移到MySQL或SQL Server进行进一步分析和报告。

---

在实际的爬虫项目中，是否需要执行数据库的事务操作取决于数据的复杂性、数据的一致性需求以及爬虫的业务逻辑。事务操作通常涉及一系列的数据库操作，这些操作要么全部成功，要么全部失败，确保数据的完整性和一致性。

### 数据依赖和完整性

如果爬取的数据跨多个表或记录，并且这些数据之间存在依赖关系，那么使用事务可以确保所有相关数据都被正确地一起更新。例如，如果你的爬虫从一个电商网站收集产品信息，并且需要更新产品表、价格表和库存表，这些更新应该在一个事务中完成，以避免数据不一致的情况。

### 错误恢复

事务可以提供一种机制，允许在发生错误时回滚到事务开始之前的状态。这对于爬虫尤其重要，因为网络抓取经常可能遇到不可预见的错误，如网络请求失败、数据格式变化等。通过使用事务，爬虫可以在遇到此类错误时撤销其对数据库的所有更改，从而避免留下不完整或错误的数据。

### 并发控制

在多线程或分布式爬虫中，多个进程或线程可能同时尝试写入数据库。事务可以帮助管理这些并发访问，确保数据的一致性和完整性。数据库的事务管理系统会处理锁定和并发问题，使开发者可以专注于业务逻辑的实现。

### 检查去重

对于涉及复杂业务逻辑的爬虫，如需要多步骤处理和决策的爬虫，事务可以确保在整个处理流程中数据的一致性。例如，一个爬虫可能需要先检查一个记录是否存在，然后基于这个检查的结果决定是插入新记录还是更新现有记录。
